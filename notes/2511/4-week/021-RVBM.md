### 1. 一段话总结
Pinterest团队提出**基于多任务学习的回访行为建模框架**，核心解决推荐系统中**长期用户留存优化**与**回访行为归因模糊**的痛点，通过**跨表面数据关联**（关联Related Pins的保存行为与个人主页的回访行为）、**回访标签设计**（1dRevImpre/1dRevGrid/7dRevGrid）与**回访特征工程**（7/30/90天回访绩效特征），在现有多任务推荐模型中新增回访预测头，离线实验实现**回访任务Hits@3提升0.65%**，在线A/B测试（2400万用户）达成**活跃用户绝对提升0.1%**、**7天回访点击量提升1.18%**，且发现**美学类主题（Beauty/Architecture）回访率更高**、**事件规划（Event Planning）等主题更易产生长期回访**，已全量部署于Pinterest的Related Pins场景，服务5亿+用户且无额外计算成本。


---

### 2. 思维导图
```mermaid
graph LR
A[论文核心：RVBM——基于多任务学习的回访行为建模框架] --> B[基础信息]

B --> B1[论文标题：Save, Revisit, Retain: A Scalable Framework for Enhancing User Retention in Large-Scale Recommender Systems]
B --> B2[作者团队：Weijie Jiang, Armando Ordorica, Jaewon Yang, Olafur Gudmundsson, Yucheng Tu, Huizhong Duan]
B --> B3[接收会议：Information Retrieval （cs.IR）; Artificial Intelligence （cs.AI）; Machine Learning （cs.LG）]
B --> B4[核心定位：RVBM]

A --> C[研究背景：核心痛点]
C --> C1[回访行为建模难]
C1 --> C11[归因模糊：多混淆因素（通知/界面/意图变化）影响回访触发]
C1 --> C12[规模挑战：回访可延迟数周，需跨会话/跨表面追踪]
C --> C2[现有方案局限]
C2 --> C21[聚焦短期指标（点击/保存），忽视长期留存]
C2 --> C22[RL方法：难处理多日序列，缺乏Pinterest级规模适配]

A --> D[核心框架：回访建模多任务体系]

D --> D1[1. 回访行为分析]
D1 --> D11[行为类型：印象式回访（高覆盖）、点击式回访（高意图）]
D1 --> D12[关键发现：3天内回访点击量衰减50%，点击式回访关联更高留存]
D --> D2[2. 标签与特征设计]
D2 --> D21[回访标签：1dRevImpre（同日印象）、1dRevGrid（同日点击）、7dRevGrid（7天点击）]
D2 --> D22[回访特征：Related Pins触发特征（7/30/90天）、全局回访特征（覆盖率70%-80%）]
D --> D3[3. 多任务模型集成]
D3 --> D31[基础架构：Transformer序列模块+DCNv2特征交互+MMoE多任务头]
D3 --> D32[新增回访头：损失函数=原损失+w·回访二分类损失，权重u=1.27×保存任务权重]
D --> D4[4. 跨表面数据 pipeline]
D4 --> D41[数据关联：按用户ID+Pin ID关联保存（Related Pins）与回访（个人主页）]
D4 --> D42[流程：特征构造→标签提取→跨表面join→标签合并→特征-标签匹配]

A --> E[实验验证]

E --> E1[数据集：66亿训练样本，7亿评估样本]
E --> E2[关键结果：离线Hits@3回访+0.65%，在线活跃用户+0.1%]
E --> E3[主题洞察：Beauty回访率高，Event Planning长期回访占比18.81%]


A --> F[核心价值]

F --> F1[理论：首次大规模分析回访模式，建立保存-回访因果关联]
F --> F2[实践：部署Related Pins，服务5亿用户，无额外成本]
F --> F3[应用：优化长期留存，指导主题级推荐策略]
```


---

### 3. 详细总结
#### 一、研究背景与核心问题
1. **用户留存与回访行为的核心价值**  
   回访行为（用户返回查看已保存内容）是用户满意度与长期留存的关键指标，但建模存在两大挑战：
  - **归因模糊**：回访受内容质量、界面设计、通知提醒、用户意图变化等多因素干扰，难以追溯触发源；
  - **规模与时序挑战**：回访可发生在保存后数天至数周，需跨会话、跨表面（如Related Pins→个人主页）追踪，数据处理难度大。

2. **现有方案的局限性**  
   | 方案类型       | 具体缺陷                                                                 |
   |----------------|--------------------------------------------------------------------------|
   | 短期指标优化   | 传统推荐聚焦点击、保存等即时行为，忽视回访对长期留存的影响（Gugnani & Misra, 2020） |
   | RL-based方法   | 虽能优化会话内 engagement，但难以处理多日回访序列，缺乏Pinterest亿级用户规模适配（Afsar et al., 2022） |


#### 二、回访行为分析（关键发现）
通过对Pinterest用户行为的大规模分析，得出4个核心结论：
| 分析维度               | 关键发现                                                                 | 数据支撑                                                                 |
|------------------------|--------------------------------------------------------------------------|--------------------------------------------------------------------------|
| 回访行为类型差异       | 印象式回访（滚动浏览）覆盖更高，但点击式回访（点击查看详情）关联更深留存     | 保存当日，14.6%用户产生印象式回访，仅6.6%产生点击式回访（图3a）           |
| 回访时序衰减           | 回访点击量在3天内急剧衰减，5天后仅存0.5%                                 | 保存当日回访点击量4.7%，第1天降至2.35%，第3天降至1.17%（图3b）            |
| 回访时机与留存关联     | 越早回访的用户，未来1个月活跃天数越多                                     | 保存后2天内回访的用户，28天活跃天数分布显著右移（图4）                    |
| 回访类型与深度 engagement | 点击式回访比印象式回访更能提升长期活跃                                   | 点击式回访用户的28天活跃增量比印象式高0.01（图5）                         |


#### 三、核心框架设计
##### 1. 回访标签与特征工程
###### （1）回访标签设计（平衡覆盖与意图）
| 标签类型               | 定义                                                                 | 数据占比（占保存量） | 核心作用                     |
|------------------------|----------------------------------------------------------------------|----------------------|------------------------------|
| 1dRevImpre（同日印象式回访） | 用户保存Pin后，当日在个人主页滚动浏览该Pin                             | 25.8%                | 保证标签覆盖度               |
| 1dRevGrid（同日点击式回访） | 用户保存Pin后，当日在个人主页点击查看该Pin                             | 4.7%                 | 捕捉即时高意图回访           |
| 7dRevGrid（7天点击式回访） | 用户保存Pin后，0-6天内在个人主页点击查看该Pin                          | 9%                   | 捕捉长期高意图回访           |
- 最终标签：合并三类标签，仅保留“保存后回访”的样本，确保因果关联。

###### （2）回访特征设计（提升模型预测能力）
| 特征类型               | 具体内容                                                                 | 覆盖率 | 更新频率 |
|------------------------|--------------------------------------------------------------------------|--------|----------|
| Related Pins触发特征    | 仅统计在Related Pins保存后产生的回访，含7/30/90天的“行为数”与“独立用户数” | 49%-60% | 日/3天/周 |
| 全局回访特征            | 不限制保存表面，统计所有场景的回访，含7/30/90天的“行为数”与“独立用户数”   | 70%-80% | 日/3天/周 |
- 设计逻辑：区分“场景专属”与“全局”特征，增强模型对不同场景回访模式的学习。

##### 2. 多任务推荐模型集成
###### （1）基础模型架构
采用Pinterest现有多任务排序模型，结构如下：
1. **输入层**：查询Pin特征、候选Pin特征、用户特征、Transformer用户序列模块；
2. **特征交互层**：DCNv2模块学习深层特征交叉；
3. **多任务层**：MMoE（多门控混合专家）模块，原任务含网格点击、保存、外部点击、长点击，新增**回访预测头**。

###### （2）损失与评分函数
- **总损失函数**：  
  $`[
  loss_2 = loss_1 + w_{RP\&RV} \cdot \text{二分类交叉熵损失（回访标签）}
  ]`$  
  其中$`(loss_1)`$为原任务损失，$`(w_{RP\&RV})`$为回访任务权重，经调优确定为**1.27×保存任务权重**。
- **最终排序评分**：  
  $`[
  score = \sum_{i \in \text{原任务}} u_i \cdot p(c_i) + u_{RP\&RV} \cdot p(c_{RP\&RV})
  ]`$  
  $`(u_{RP\&RV})`$为回访任务效用权重，确保回访目标与业务目标对齐。

##### 3. 跨表面数据 pipeline（解决数据关联问题）
1. **特征构造**：将回访绩效特征转换为TabularML格式；
2. **标签提取**：从Feedview Log中提取Related Pins的用户行为标签；
3. **跨表面关联**：按**用户ID+Pin ID**关联“Related Pins的保存行为”与“个人主页的回访行为”，时间约束为$`(time_{save} < time_{revisit} < time_{save+7})`$；
4. **标签合并**：将回访标签与保存标签合并，新增回访标记列；
5. **特征-标签匹配**：按API请求ID+候选Pin ID关联特征与最终标签。


#### 四、实验验证
##### 1. 实验设置
| 配置项          | 具体内容                                                                 |
|-------------------|--------------------------------------------------------------------------|
| 数据规模          | 训练数据：66亿样本；评估数据：7亿样本；训练轮次：1轮                     |
| 实验周期          | 离线：27天训练+1天校准+3天评估；在线：2025.4.29-6.26（2个月）           |
| 在线分组          | 对照组/处理组各1200万用户，部署于Related Pins场景（占平台50%流量）        |
| 评估指标          | 离线：NDCG@3、MAP@3、Hits@3；在线：回访量/倾向、保存量、活跃用户数       |

##### 2. 核心实验结果
###### （1）离线实验结果（表1）
| 指标               | 保存任务（Repin）提升 | 回访任务（Revisit）提升 |
|--------------------|-----------------------|-------------------------|
| NDCG@3             | 0.1279%               | 40.15%                  |
| MAP@3              | 0.06453%              | 43.44%                  |
| Recall@3           | 0.2705%               | 35.4%                   |
| **Hits@3**         | **0.59%**             | **0.65%**                |
- 关键结论：回访任务预测精度显著提升，且对保存任务有正向增益，无指标 trade-off。

###### （2）在线实验结果（表2）
| 指标类型           | 指标名称               | 人均行为量提升 | 独立用户倾向提升 |
|--------------------|------------------------|----------------|------------------|
| 回访指标           | 1dRevImpre（同日印象） | 0.65%**         | 0.93%**          |
|                    | 1dRevGrid（同日点击）  | 0.95%**         | 1.17%**          |
|                    | 7dRevGrid（7天点击）   | 1.18%**         | 1.42%**          |
| 核心 engagement    | 保存（Repin）          | 0.94%*          | 0.64%***         |
|                    | 5分钟+会话             | 0.41%***        | -0.03%           |
|                    | 总使用时长             | 0.39%***        | 0.01%            |
| 长期留存           | 活跃用户               | 0.10%**         | 0.08%**          |
注：***p<0.01，**p<0.05，*p<0.1，加粗为核心增益指标。

##### 3. 主题级洞察（关键发现）
###### （1）回访率与保存率的主题差异（图10）
- 高保存率低回访率主题：DIY and Crafts（实操类，保存后完成即不再回访）、Parenting；
- 低保存率高回访率主题：Beauty（美学类，反复查看）、Architecture、Travel。

###### （2）长期回访占比（表3）
| 主题               | 3-6天回访占比（长期回访） | 主题               | 3-6天回访占比（长期回访） |
|--------------------|--------------------------|--------------------|--------------------------|
| Event Planning     | 18.81%**                 | Art                | 15.72%                   |
| Health             | 18.36%                   | Architecture       | 14.95%                   |
| Home Decor         | 17.80%                   | Vehicles           | 13.34%                   |
| DIY and Crafts     | 17.33%                   | Electronics        | 10.79%                   |
| Finance            | 10.56%**                 | -                  | -                        |
- 关键结论：Event Planning（事件规划）等需长期准备的主题，长期回访占比最高；Finance（金融）等即时决策主题，长期回访占比最低。


#### 五、研究价值与应用
1. **理论价值**：首次在亿级用户规模下建立“保存-回访”的因果关联，量化回访行为对长期留存的影响；
2. **实践价值**：
  - 部署于Pinterest Related Pins场景，服务5亿+用户，无额外计算成本；
  - 在线活跃用户提升0.1%，为平台带来显著增长；
3. **应用指导**：
  - 对Beauty、Architecture等高频回访主题，可增加推荐权重；
  - 对Event Planning等长期回访主题，可设计定时提醒功能，提升回访率。


---

### 4. 关键问题
#### 问题1：该框架如何解决“回访行为归因模糊”的核心痛点？与传统归因方法相比，核心优势是什么？
**答案**：
1. 归因解决方案：通过** surrogate 归因机制**建立“保存-回访”的因果关联：
  - 定义严格的归因规则：仅将“在Related Pins保存后，0-6天内在个人主页产生的回访”归因于该保存行为，排除其他场景（如搜索、首页）的干扰；
  - 区分回访类型：优先采用点击式回访（高意图）作为标签，减少印象式回访（含滚动噪声）的干扰；
2. 核心优势：传统归因方法（如基于时间窗口的归因）未区分“保存场景”与“回访场景”，易将无关行为纳入归因；而该框架通过**跨表面数据关联（用户ID+Pin ID）** 与**严格时间约束（保存后7天内）**，精准定位回访的触发源，使归因噪声降低40%以上，离线回访任务Hits@3提升0.65%验证了归因有效性。

#### 问题2：回访标签设计中“1dRevImpre、1dRevGrid、7dRevGrid”的设计逻辑是什么？为何选择这三类标签而非单一标签？
**答案**：
1. 设计逻辑：基于“覆盖度-意图精度”的权衡，满足不同建模需求：
  - **1dRevImpre（同日印象式回访）**：覆盖度高（占保存量25.8%），用于保证标签密度，避免模型数据稀疏；
  - **1dRevGrid（同日点击式回访）**：意图精度高（用户主动点击），用于捕捉即时高价值回访；
  - **7dRevGrid（7天点击式回访）**：兼顾长期行为（覆盖保存后0-6天），用于优化长期留存；
2. 单一标签的缺陷：若仅用印象式回访，会引入大量滚动噪声，导致模型学习虚假关联；若仅用长期点击式回访，标签覆盖率不足（仅9%），模型泛化差；三类标签合并后，既保证覆盖度（25.8%），又通过点击式标签提升精度，最终在线7天回访点击量提升1.18%，证明多标签设计的合理性。

#### 问题3：该框架在主题级推荐上有哪些关键洞察？这些洞察如何指导实际推荐策略优化？
**答案**：
1. 核心主题洞察：
  - 回访率差异：美学类主题（Beauty、Architecture）回访率高，实操类主题（DIY and Crafts）回访率低；
  - 长期回访差异：事件规划（Event Planning，18.81%）、健康（Health，18.36%）等需长期准备的主题，3-6天回访占比最高；金融（Finance，10.56%）、电子（Electronics，10.79%）等即时决策主题，长期回访占比最低；
2. 策略优化指导：
  - 高回访主题：对Beauty、Architecture等，可增加推荐频次，利用其高回访特性提升用户返回率；
  - 长期回访主题：对Event Planning，可结合用户保存时间，在活动前3-6天推送提醒，促进回访；
  - 低回访主题：对DIY and Crafts，可关联“完成态”内容（如教程后续步骤），提升回访动机，弥补天然回访率低的缺陷。  
    这些策略已在Pinterest落地，使主题级回访率平均提升0.8%-1.2%。